import{s as P,g as U,r as p,y as R,bm as J,o as c,c as K,w as k,_ as W,c2 as b,a as C,d as q,u as I,c6 as H,e as M,b as e,k as r,B as N,t as f,q as Q,c7 as X,F as G,p as D,c8 as Y,f as m,v as u,S as Z,c9 as ee,ca as te,L as se,I as oe,$ as ae,R as ie,T as ne}from"./index-46194475.js";import"./bootstrap.min-63fd26ea.js";const n=h=>(ie("data-v-0880e1d1"),h=h(),ne(),h),le={class:"container pb-3"},de={class:"col-12 font-bold mb-2"},ce=["onClick"],re={class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},me=["onClick"],pe=n(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",null,[e("div",{class:"profile-img w-100 border-4 mb-3"},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW")])],-1)),ue=[pe],he={class:"h-100 card text-center border-0 rounded bg-white shadow"},_e={class:"card-header py-4"},ge={class:"profile-img mb-3"},ve={class:"img-circle-wrapper"},be=["src"],fe={class:"h4 font-bold text-body mb-1"},xe={class:"text-break text-truncate",style:{"white-space":"wrap"}},we={class:"position-absolute top-0 right-0 dropdown p-3"},ye=n(()=>e("div",{class:"cursor-pointer",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},[e("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"})])],-1)),Te={class:"dropdown-menu dropdown-menu-right","aria-labelledby":"dropdownMenuButton"},ke=["onClick"],Ce=["onClick"],Ie={class:"row"},Me={class:"col-12 mb-3"},Ne=n(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",{class:"d-flex align-items-center"},[e("div",{class:"profile-img border-4 mr-2",style:{width:"40px"}},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW THEME")])],-1)),Ge=[Ne],De={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},Se={class:"modal-dialog modal-dialog-centered",role:"document"},Be={class:"modal-content"},$e=n(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),ze=n(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此標籤？")],-1)),Le={class:"modal-footer border-0"},Ve=n(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),je={class:"modal fade",id:"editModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},Ae={class:"modal-dialog modal-dialog-centered",role:"document"},Ee={class:"modal-content"},Fe={class:"modal-header border-0"},Oe={class:"modal-title"},Pe=n(()=>e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")],-1)),Ue={class:"modal-body"},Re={id:"form-edit",class:"d-flex align-items-start"},Je={class:"d-block w-25"},Ke={class:"d-flex flex-column w-75 mx-auto cursor-pointer image-container"},We={class:"img-circle-wrapper mb-2"},qe=["src"],He={viewBox:"0 0 24 24",class:"inline-block image-edit-icon",style:{color:"white"}},Qe=["d"],Xe=n(()=>e("div",{class:"w-100",style:{"text-align":"center","font-size":"13px"}},"上傳圖片",-1)),Ye={class:"w-75 container-fluid"},Ze={class:"d-flex align-items-center mb-2"},et=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),tt={class:"d-flex align-items-center mb-2"},st=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"名稱",-1)),ot={class:"d-flex align-items-center mb-2"},at=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"描述",-1)),it={class:"modal-footer flex-column align-items-end border-0"},nt=n(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),lt=n(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),dt=["disabled"],ct={class:"modal fade",id:"updateModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},rt={class:"modal-dialog modal-dialog-centered",role:"document"},mt={class:"modal-content"},pt=n(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"更新主題名稱"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),ut={class:"modal-body"},ht={id:"form-edit",class:"d-flex align-items-start"},_t={class:"w-75 container-fluid"},gt={class:"d-flex align-items-center mb-2"},vt=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),bt={class:"d-flex align-items-center mb-2"},ft=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"新主題名稱",-1)),xt={class:"modal-footer flex-column align-items-end border-0"},wt=n(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),yt=n(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),S="https://s3.ap-northeast-1.amazonaws.com/inffits.com/mkt/img/empty.jpg",Tt="請填寫完整資訊",kt={__name:"ThemeView",setup(h){const B=U();p(B.MainConfig.Brand);const $=p([]),x=p([]),o=p({}),_=p(""),z=a=>{const t=a.target.files[0];if(!t)return;const i=new Image;i.src=URL.createObjectURL(t),i.onload=()=>{if(i.width/i.height!==3/4){alert("圖片比例不符合3:4");return}else b.put(`https://x24sw7agoh.execute-api.ap-northeast-2.amazonaws.com/v2/inffitsmanager.assets/tmp/tmp/${t.name}`,t,{headers:{"Content-Type":t.type}}).then(s=>{const l="https://s3.ap-northeast-2.amazonaws.com/inffitsmanager.assets/tmp/tmp/"+t.name;console.log(l),o.value.Imgsrc=l}).catch(s=>{console.error(s),console.log("IMG UPLOAD FAIL")})}},L=a=>{d({TagGroup:a},!0,"updateModal")},V=async a=>{if(typeof AWS>"u"){const t="ap-northeast-1",i="ap-northeast-1:ec9d0f5d-ae3e-4ff2-986f-2025ddbedf1a",s=ee({client:new te({region:t}),identityPoolId:i}),v=new se({region:t,credentials:s}),l="INFS",w=a,y=_.value,F={FunctionName:"mkt_extensions_rename_proc",InvocationType:"RequestResponse",LogType:"Tail",Payload:JSON.stringify({Brand:l,pre_taggroup:w,post_taggroup:y})};try{const T=new oe(F),O=await v.send(T);console.log(O),g(),d({},!0,"updateModal"),_.value=""}catch(T){console.error(T)}}},g=()=>{b.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand=INFS&Per_Page=100&Page=1").then(a=>{const t={};$.value=a.data.models,a.data.models.forEach(i=>{t[i.TagGroup]||(t[i.TagGroup]=[]),t[i.TagGroup].push(i)}),x.value=[];for(const i in t)x.value.push({group:i,tags:t[i]})})},d=(a={TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},t=!0,i="editModal",s="")=>{o.value=Object.assign({TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},JSON.parse(JSON.stringify(a))),o.value.Key=s,t&&j(i)},j=a=>{ae(`#${a}`).modal("toggle")},A=()=>{b.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_tag",{Brand:"INFS",Data:o.value}).then(a=>{console.log(a),g(),d({},!0,"editModal")})},E=()=>{b.delete(`https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_tag?Brand=INFS&Tag=${o.value.Tag}`).then(a=>{console.log(a),g(),d({},!0,"deleteModal")})};return R(()=>{g()}),(a,t)=>{const i=J("tooltip");return c(),K(W,null,{default:k(()=>[C(Z,null,{default:k(()=>[C(q,{icon:I(H),title:"主題標籤管理",main:""},{default:k(()=>[M("   ")]),_:1},8,["icon"]),e("div",le,[(c(!0),r(G,null,N(x.value,(s,v)=>(c(),r("div",{key:v,class:"row mb-3"},[e("h4",de,[e("div",{class:"h5 pl-4 bg-white border d-flex align-items-center justify-content-center rounded-pill cursor-pointer tag-title",style:{"max-width":"max-content","box-shadow":"rgba(0,0,0,0.15) 0 2px 8px","padding-top":"3px","padding-bottom":"3px","font-weight":"600"},onClick:l=>L(s.group)},[M(f(s.group)+" ",1),C(Q,{path:I(X),class:"mx-2"},null,8,["path"])],8,ce)]),e("div",re,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:l=>d({TagGroup:s.group})},ue,8,me)]),(c(!0),r(G,null,N(s.tags,(l,w)=>(c(),r("div",{key:w,class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},[e("div",he,[e("div",_e,[e("div",ge,[e("div",ve,[e("div",{class:D(["img-circle img-fluid bg-gray-light",l.Imgsrc?"":"d-none"])},null,2),e("img",{class:D(["img-circle img-fluid",l.Imgsrc?"":"d-none"]),src:l.Imgsrc?l.Imgsrc:S,alt:""},null,10,be)])]),e("div",fe,f(l.Name),1),e("small",xe,f(l.Description),1),e("div",we,[ye,e("div",Te,[e("a",{class:"dropdown-item",onClick:y=>d(l,!0,"editModal",a.Key="edit")},"Edit",8,ke),e("a",{class:"dropdown-item",onClick:y=>d(l,!0,"deleteModal")},"Delete",8,Ce)])])])])]))),128))]))),128)),e("div",Ie,[e("div",Me,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:t[0]||(t[0]=s=>d())},Ge)])])]),e("div",De,[e("div",Se,[e("div",Be,[$e,ze,e("div",Le,[Ve,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=s=>E())},"刪除")])])])]),e("div",je,[e("div",Ae,[e("div",Ee,[e("div",Fe,[e("h5",Oe,f(o.value.Key=="edit"?"編輯":"新增")+"標籤",1),Pe]),e("div",Ue,[e("form",Re,[e("label",Je,[e("label",Ke,[e("div",We,[e("img",{class:"img-circle img-fluid",id:"img-edit",src:o.value.Imgsrc?o.value.Imgsrc:S,alt:""},null,8,qe),(c(),r("svg",He,[e("path",{fill:"currentColor",d:I(Y)},null,8,Qe)]))]),e("input",{type:"file",class:"d-none",onChange:z,accept:"image/*"},null,32)]),Xe]),e("div",Ye,[e("div",Ze,[et,m(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.TagGroup=s),class:"form-control"},null,512),[[u,o.value.TagGroup]])]),e("div",tt,[st,m(e("input",{type:"text",name:"Name","onUpdate:modelValue":t[3]||(t[3]=s=>o.value.Name=s),class:"form-control"},null,512),[[u,o.value.Name]])]),e("div",ot,[at,m(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[4]||(t[4]=s=>o.value.Description=s),class:"form-control"},null,512),[[u,o.value.Description]])])])])]),e("div",it,[nt,e("div",null,[lt,m((c(),r("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=s=>A()),disabled:!o.value.TagGroup||!o.value.Name||!o.value.Description},[M("存檔")],8,dt)),[[i,Tt]])])])])])]),e("div",ct,[e("div",rt,[e("div",mt,[pt,e("div",ut,[e("form",ht,[e("div",_t,[e("div",gt,[vt,m(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[6]||(t[6]=s=>o.value.TagGroup=s),disabled:"",class:"form-control"},null,512),[[u,o.value.TagGroup]])]),e("div",bt,[ft,m(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[7]||(t[7]=s=>_.value=s),class:"form-control"},null,512),[[u,_.value]])])])])]),e("div",xt,[wt,e("div",null,[yt,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=s=>V(o.value.TagGroup))},"存檔")])])])])])]),_:1})]),_:1})}}},Nt=P(kt,[["__scopeId","data-v-0880e1d1"]]);export{Nt as default};
