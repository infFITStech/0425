import{s as R,g as F,r as p,y as J,bm as K,o as c,c as W,w as C,_ as q,c2 as f,a as I,d as H,u as M,c6 as Q,e as D,b as e,k as r,B as G,t as x,q as X,c7 as Y,F as N,p as B,c8 as Z,f as m,v as u,S as ee,c9 as te,ca as se,L as oe,I as ae,$ as ie,R as ne,T as le}from"./index-cca117b0.js";import"./bootstrap.min-22bda91e.js";const n=h=>(ne("data-v-432c8231"),h=h(),le(),h),de={class:"container pb-3"},ce={class:"col-12 font-bold mb-2"},re=["onClick"],me={class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},pe=["onClick"],ue=n(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",null,[e("div",{class:"profile-img w-100 border-4 mb-3"},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW")])],-1)),he=[ue],_e={class:"h-100 card text-center border-0 rounded bg-white shadow"},ge={class:"card-header py-4"},ve={class:"profile-img mb-3"},be={class:"img-circle-wrapper"},fe=["src"],xe={class:"h4 font-bold text-body mb-1"},we={class:"text-break text-truncate",style:{"white-space":"wrap"}},ye={class:"position-absolute top-0 right-0 dropdown p-3"},Te=n(()=>e("div",{class:"cursor-pointer",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},[e("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"})])],-1)),ke={class:"dropdown-menu dropdown-menu-right","aria-labelledby":"dropdownMenuButton"},Ce=["onClick"],Ie=["onClick"],Me={class:"row"},De={class:"col-12 mb-3"},Ge=n(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",{class:"d-flex align-items-center"},[e("div",{class:"profile-img border-4 mr-2",style:{width:"40px"}},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW THEME")])],-1)),Ne=[Ge],Be={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},$e={class:"modal-dialog modal-dialog-centered",role:"document"},Se={class:"modal-content"},ze=n(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),Le=n(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此標籤？")],-1)),Ve={class:"modal-footer border-0"},je=n(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),Ae={class:"modal fade",id:"editModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},Ee={class:"modal-dialog modal-dialog-centered",role:"document"},Oe={class:"modal-content"},Pe={class:"modal-header border-0"},Ue={class:"modal-title"},Re=n(()=>e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")],-1)),Fe={class:"modal-body"},Je={id:"form-edit",class:"d-flex align-items-start"},Ke={class:"d-block w-25"},We={class:"d-flex flex-column w-75 mx-auto cursor-pointer image-container"},qe={class:"img-circle-wrapper mb-2"},He=["src"],Qe={viewBox:"0 0 24 24",class:"inline-block image-edit-icon",style:{color:"white"}},Xe=["d"],Ye=n(()=>e("div",{class:"w-100",style:{"text-align":"center","font-size":"13px"}},"上傳圖片",-1)),Ze={class:"w-75 container-fluid"},et={class:"d-flex align-items-center mb-2"},tt=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),st={class:"d-flex align-items-center mb-2"},ot=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"名稱",-1)),at={class:"d-flex align-items-center mb-2"},it=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"描述",-1)),nt={class:"modal-footer flex-column align-items-end border-0"},lt=n(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),dt=n(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),ct=["disabled"],rt={class:"modal fade",id:"updateModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},mt={class:"modal-dialog modal-dialog-centered",role:"document"},pt={class:"modal-content"},ut=n(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"更新主題名稱"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),ht={class:"modal-body"},_t={id:"form-edit",class:"d-flex align-items-start"},gt={class:"w-75 container-fluid"},vt={class:"d-flex align-items-center mb-2"},bt=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),ft={class:"d-flex align-items-center mb-2"},xt=n(()=>e("label",{class:"pr-2 flex-shrink-0"},"新主題名稱",-1)),wt={class:"modal-footer flex-column align-items-end border-0"},yt=n(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),Tt=n(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),$="https://s3.ap-northeast-1.amazonaws.com/inffits.com/mkt/img/empty.jpg",kt="請填寫完整資訊",Ct={__name:"ThemeView",setup(h){const S=F(),_=p(S.MainConfig.BRAND),z=p([]),w=p([]),o=p({}),g=p(""),L=a=>{const t=a.target.files[0];if(!t)return;const i=new Image;i.src=URL.createObjectURL(t),i.onload=()=>{if(i.width/i.height!==3/4){alert("圖片比例不符合3:4");return}else f.put(`https://x24sw7agoh.execute-api.ap-northeast-2.amazonaws.com/v2/inffitsmanager.assets/tmp/tmp/${t.name}`,t,{headers:{"Content-Type":t.type}}).then(s=>{const l="https://s3.ap-northeast-2.amazonaws.com/inffitsmanager.assets/tmp/tmp/"+t.name;console.log(l),o.value.Imgsrc=l}).catch(s=>{console.error(s),console.log("IMG UPLOAD FAIL")})}},V=a=>{d({TagGroup:a},!0,"updateModal")},j=async a=>{if(typeof AWS>"u"){const t="ap-northeast-1",i="ap-northeast-1:ec9d0f5d-ae3e-4ff2-986f-2025ddbedf1a",s=te({client:new se({region:t}),identityPoolId:i}),b=new oe({region:t,credentials:s}),l=_.value,y=a,T=g.value,P={FunctionName:"mkt_extensions_rename_proc",InvocationType:"RequestResponse",LogType:"Tail",Payload:JSON.stringify({Brand:l,pre_taggroup:y,post_taggroup:T})};try{const k=new ae(P),U=await b.send(k);console.log(U),v(),d({},!0,"updateModal"),g.value=""}catch(k){console.error(k)}}},v=()=>{f.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand="+_.value+"&Per_Page=100&Page=1").then(a=>{const t={};z.value=a.data.models,a.data.models.forEach(i=>{t[i.TagGroup]||(t[i.TagGroup]=[]),t[i.TagGroup].push(i)}),w.value=[];for(const i in t)w.value.push({group:i,tags:t[i]})})},d=(a={TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},t=!0,i="editModal",s="")=>{o.value=Object.assign({TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},JSON.parse(JSON.stringify(a))),o.value.Key=s,t&&A(i)},A=a=>{ie(`#${a}`).modal("toggle")},E=()=>{f.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_tag",{Brand:_.value,Data:o.value}).then(a=>{console.log(a),v(),d({},!0,"editModal")})},O=()=>{f.delete("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_tag?Brand="+_.value+`&Tag=${o.value.Tag}`).then(a=>{console.log(a),v(),d({},!0,"deleteModal")})};return J(()=>{}),v(),(a,t)=>{const i=K("tooltip");return c(),W(q,null,{default:C(()=>[I(ee,null,{default:C(()=>[I(H,{icon:M(Q),title:"主題標籤管理",main:""},{default:C(()=>[D("   ")]),_:1},8,["icon"]),e("div",de,[(c(!0),r(N,null,G(w.value,(s,b)=>(c(),r("div",{key:b,class:"row mb-3"},[e("h4",ce,[e("div",{class:"h5 pl-4 bg-white border d-flex align-items-center justify-content-center rounded-pill cursor-pointer tag-title",style:{"max-width":"max-content","box-shadow":"rgba(0,0,0,0.15) 0 2px 8px","padding-top":"3px","padding-bottom":"3px","font-weight":"600"},onClick:l=>V(s.group)},[D(x(s.group)+" ",1),I(X,{path:M(Y),class:"mx-2"},null,8,["path"])],8,re)]),e("div",me,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:l=>d({TagGroup:s.group})},he,8,pe)]),(c(!0),r(N,null,G(s.tags,(l,y)=>(c(),r("div",{key:y,class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},[e("div",_e,[e("div",ge,[e("div",ve,[e("div",be,[e("div",{class:B(["img-circle img-fluid bg-gray-light",l.Imgsrc?"":"d-none"])},null,2),e("img",{class:B(["img-circle img-fluid",l.Imgsrc?"":"d-none"]),src:l.Imgsrc?l.Imgsrc:$,alt:""},null,10,fe)])]),e("div",xe,x(l.Name),1),e("small",we,x(l.Description),1),e("div",ye,[Te,e("div",ke,[e("a",{class:"dropdown-item",onClick:T=>d(l,!0,"editModal",a.Key="edit")},"Edit",8,Ce),e("a",{class:"dropdown-item",onClick:T=>d(l,!0,"deleteModal")},"Delete",8,Ie)])])])])]))),128))]))),128)),e("div",Me,[e("div",De,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:t[0]||(t[0]=s=>d())},Ne)])])]),e("div",Be,[e("div",$e,[e("div",Se,[ze,Le,e("div",Ve,[je,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=s=>O())},"刪除")])])])]),e("div",Ae,[e("div",Ee,[e("div",Oe,[e("div",Pe,[e("h5",Ue,x(o.value.Key=="edit"?"編輯":"新增")+"標籤",1),Re]),e("div",Fe,[e("form",Je,[e("label",Ke,[e("label",We,[e("div",qe,[e("img",{class:"img-circle img-fluid",id:"img-edit",src:o.value.Imgsrc?o.value.Imgsrc:$,alt:""},null,8,He),(c(),r("svg",Qe,[e("path",{fill:"currentColor",d:M(Z)},null,8,Xe)]))]),e("input",{type:"file",class:"d-none",onChange:L,accept:"image/*"},null,32)]),Ye]),e("div",Ze,[e("div",et,[tt,m(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.TagGroup=s),class:"form-control"},null,512),[[u,o.value.TagGroup]])]),e("div",st,[ot,m(e("input",{type:"text",name:"Name","onUpdate:modelValue":t[3]||(t[3]=s=>o.value.Name=s),class:"form-control"},null,512),[[u,o.value.Name]])]),e("div",at,[it,m(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[4]||(t[4]=s=>o.value.Description=s),class:"form-control"},null,512),[[u,o.value.Description]])])])])]),e("div",nt,[lt,e("div",null,[dt,m((c(),r("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=s=>E()),disabled:!o.value.TagGroup||!o.value.Name||!o.value.Description},[D("存檔")],8,ct)),[[i,kt]])])])])])]),e("div",rt,[e("div",mt,[e("div",pt,[ut,e("div",ht,[e("form",_t,[e("div",gt,[e("div",vt,[bt,m(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[6]||(t[6]=s=>o.value.TagGroup=s),disabled:"",class:"form-control"},null,512),[[u,o.value.TagGroup]])]),e("div",ft,[xt,m(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[7]||(t[7]=s=>g.value=s),class:"form-control"},null,512),[[u,g.value]])])])])]),e("div",wt,[yt,e("div",null,[Tt,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=s=>j(o.value.TagGroup))},"存檔")])])])])])]),_:1})]),_:1})}}},Gt=R(Ct,[["__scopeId","data-v-432c8231"]]);export{Gt as default};
