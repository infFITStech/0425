import{m as U,u as O,r as m,q as R,o as r,c as J,w as T,_ as K,c2 as b,a as k,X as W,D as C,Y as q,e as I,b as e,i as p,y as M,t as f,l as H,c3 as Q,F as N,n as G,c4 as X,d as u,v as h,S as Y,c5 as Z,c6 as ee,L as te,I as se,a2 as oe,Q as ae,R as ne}from"./index-e90cb2fa.js";import"./bootstrap.min-d3ee99d8.js";const a=_=>(ae("data-v-18c9b86c"),_=_(),ne(),_),ie={class:"container pb-3"},le={class:"col-12 font-bold mb-2"},de=["onClick"],ce={class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},re=["onClick"],me=a(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",null,[e("div",{class:"profile-img w-100 border-4 mb-3"},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW")])],-1)),pe=[me],ue={class:"h-100 card text-center border-0 rounded bg-white shadow"},he={class:"card-header py-4"},_e={class:"profile-img mb-3"},ge={class:"img-circle-wrapper"},ve=["src"],be={class:"h4 font-bold text-body mb-1"},fe={class:"text-break text-truncate",style:{"white-space":"wrap"}},xe={class:"position-absolute top-0 right-0 dropdown p-3"},we=a(()=>e("div",{class:"cursor-pointer",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-three-dots-vertical",viewBox:"0 0 16 16"},[e("path",{d:"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"})])],-1)),ye={class:"dropdown-menu dropdown-menu-right","aria-labelledby":"dropdownMenuButton"},Te=["onClick"],ke=["onClick"],Ce={class:"row"},Ie={class:"col-12 mb-3"},Me=a(()=>e("div",{class:"card-body d-flex flex-column align-items-center justify-content-center"},[e("div",{class:"d-flex align-items-center"},[e("div",{class:"profile-img border-4 mr-2",style:{width:"40px"}},[e("div",{class:"img-circle-wrapper text-primary"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",class:"bi bi-plus img-circle",viewBox:"0 0 16 16"},[e("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})])])]),e("p",{class:"h5 font-bold text-balck-50 mb-1"},"ADD NEW THEME")])],-1)),Ne=[Me],Ge={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},De={class:"modal-dialog modal-dialog-centered",role:"document"},Se={class:"modal-content"},Be=a(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),$e=a(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此標籤？")],-1)),ze={class:"modal-footer border-0"},Le=a(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),Ve={class:"modal fade",id:"editModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},Ae={class:"modal-dialog modal-dialog-centered",role:"document"},je={class:"modal-content"},Ee={class:"modal-header border-0"},Fe={class:"modal-title"},Pe=a(()=>e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")],-1)),Ue={class:"modal-body"},Oe={id:"form-edit",class:"d-flex align-items-start"},Re={class:"d-block w-25"},Je={class:"d-flex flex-column w-75 mx-auto cursor-pointer image-container"},Ke={class:"img-circle-wrapper mb-2"},We=["src"],qe={viewBox:"0 0 24 24",class:"inline-block image-edit-icon",style:{color:"white"}},He=["d"],Qe=a(()=>e("div",{class:"w-100",style:{"text-align":"center","font-size":"13px"}},"上傳圖片",-1)),Xe={class:"w-75 container-fluid"},Ye={class:"d-flex align-items-center mb-2"},Ze=a(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),et={class:"d-flex align-items-center mb-2"},tt=a(()=>e("label",{class:"pr-2 flex-shrink-0"},"名稱",-1)),st={class:"d-flex align-items-center mb-2"},ot=a(()=>e("label",{class:"pr-2 flex-shrink-0"},"描述",-1)),at={class:"modal-footer flex-column align-items-end border-0"},nt=a(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),it=a(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),lt={class:"modal fade",id:"updateModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},dt={class:"modal-dialog modal-dialog-centered",role:"document"},ct={class:"modal-content"},rt=a(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"更新主題名稱"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),mt={class:"modal-body"},pt={id:"form-edit",class:"d-flex align-items-start"},ut={class:"w-75 container-fluid"},ht={class:"d-flex align-items-center mb-2"},_t=a(()=>e("label",{class:"pr-2 flex-shrink-0"},"主題名稱",-1)),gt={class:"d-flex align-items-center mb-2"},vt=a(()=>e("label",{class:"pr-2 flex-shrink-0"},"新主題名稱",-1)),bt={class:"modal-footer flex-column align-items-end border-0"},ft=a(()=>e("div",{id:"hint-edit",class:"d-none text-right text-danger mb-1"},"請填寫完整資訊",-1)),xt=a(()=>e("button",{type:"button",class:"btn btn-secondary mr-2","data-dismiss":"modal"},"取消編輯",-1)),D="default.png",wt={__name:"ThemeView",setup(_){const S=O();m(S.MainConfig.Brand);const B=m([]),x=m([]),n=m({}),g=m(""),$=o=>{const t=o.target.files[0];if(!t)return;const s=new Image;s.src=URL.createObjectURL(t),s.onload=()=>{if(s.width/s.height!==3/4){alert("圖片比例不符合3:4");return}else b.put(`https://x24sw7agoh.execute-api.ap-northeast-2.amazonaws.com/v2/inffitsmanager.assets/tmp/tmp/${t.name}`,t,{headers:{"Content-Type":t.type}}).then(d=>{const c="https://s3.ap-northeast-2.amazonaws.com/inffitsmanager.assets/tmp/tmp/"+t.name;console.log(c),n.value.Imgsrc=c}).catch(d=>{console.error(d),console.log("IMG UPLOAD FAIL")})}},z=o=>{l({TagGroup:o},!0,"updateModal")},L=async o=>{if(typeof AWS>"u"){const t="ap-northeast-1",s="ap-northeast-1:ec9d0f5d-ae3e-4ff2-986f-2025ddbedf1a",d=Z({client:new ee({region:t}),identityPoolId:s}),i=new te({region:t,credentials:d}),c="INFS",w=o,E=g.value,F={FunctionName:"mkt_extensions_rename_proc",InvocationType:"RequestResponse",LogType:"Tail",Payload:JSON.stringify({Brand:c,pre_taggroup:w,post_taggroup:E})};try{const y=new se(F),P=await i.send(y);console.log(P),v(),l({},!0,"updateModal"),g.value=""}catch(y){console.error(y)}}},v=()=>{b.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand=INFS&Per_Page=100&Page=1").then(o=>{const t={};B.value=o.data.models,o.data.models.forEach(s=>{t[s.TagGroup]||(t[s.TagGroup]=[]),t[s.TagGroup].push(s)}),x.value=[];for(const s in t)x.value.push({group:s,tags:t[s]})})},l=(o={TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},t=!0,s="editModal",d="")=>{n.value=Object.assign({TagGroup:"",Tag:String(new Date().getTime()),Name:"",Imgsrc:"",Description:""},JSON.parse(JSON.stringify(o))),n.value.Key=d,t&&V(s)},V=o=>{oe(`#${o}`).modal("toggle")},A=()=>{b.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_tag",{Brand:"INFS",Data:n.value}).then(o=>{console.log(o),v(),l({},!0,"editModal")})},j=()=>{b.delete(`https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_tag?Brand=INFS&Tag=${n.value.Tag}`).then(o=>{console.log(o),v(),l({},!0,"deleteModal")})};return R(()=>{v()}),(o,t)=>(r(),J(K,null,{default:T(()=>[k(Y,null,{default:T(()=>[k(W,{icon:C(q),title:"主題標籤管理",main:""},{default:T(()=>[I("   ")]),_:1},8,["icon"]),e("div",ie,[(r(!0),p(N,null,M(x.value,(s,d)=>(r(),p("div",{key:d,class:"row mb-3"},[e("h4",le,[e("div",{class:"h5 pl-4 bg-white border d-flex align-items-center justify-content-center rounded-pill cursor-pointer tag-title",style:{"max-width":"max-content","box-shadow":"rgba(0,0,0,0.15) 0 2px 8px","padding-top":"3px","padding-bottom":"3px","font-weight":"600"},onClick:i=>z(s.group)},[I(f(s.group)+" ",1),k(H,{path:C(Q),class:"mx-2"},null,8,["path"])],8,de)]),e("div",ce,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:i=>l({TagGroup:s.group})},pe,8,re)]),(r(!0),p(N,null,M(s.tags,(i,c)=>(r(),p("div",{key:c,class:"col-lg-3 col-md-4 col-sm-12 col-12 mb-3"},[e("div",ue,[e("div",he,[e("div",_e,[e("div",ge,[e("div",{class:G(["img-circle img-fluid bg-gray-light",i.Imgsrc?"":"d-none"])},null,2),e("img",{class:G(["img-circle img-fluid",i.Imgsrc?"":"d-none"]),src:i.Imgsrc?i.Imgsrc:D,alt:""},null,10,ve)])]),e("div",be,f(i.Name),1),e("small",fe,f(i.Description),1),e("div",xe,[we,e("div",ye,[e("a",{class:"dropdown-item",onClick:w=>l(i,!0,"editModal",o.Key="edit")},"Edit",8,Te),e("a",{class:"dropdown-item",onClick:w=>l(i,!0,"deleteModal")},"Delete",8,ke)])])])])]))),128))]))),128)),e("div",Ce,[e("div",Ie,[e("div",{class:"h-100 flex-grow-1 card shadow text-center bg-white border-0 rounded cursor-pointer",onClick:t[0]||(t[0]=s=>l())},Ne)])])]),e("div",Ge,[e("div",De,[e("div",Se,[Be,$e,e("div",ze,[Le,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=s=>j())},"刪除")])])])]),e("div",Ve,[e("div",Ae,[e("div",je,[e("div",Ee,[e("h5",Fe,f(n.value.Key=="edit"?"編輯":"新增")+"標籤",1),Pe]),e("div",Ue,[e("form",Oe,[e("label",Re,[e("label",Je,[e("div",Ke,[e("img",{class:"img-circle img-fluid",id:"img-edit",src:n.value.Imgsrc?n.value.Imgsrc:D,alt:""},null,8,We),(r(),p("svg",qe,[e("path",{fill:"currentColor",d:C(X)},null,8,He)]))]),e("input",{type:"file",class:"d-none",onChange:$,accept:"image/*"},null,32)]),Qe]),e("div",Xe,[e("div",Ye,[Ze,u(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[2]||(t[2]=s=>n.value.TagGroup=s),class:"form-control"},null,512),[[h,n.value.TagGroup]])]),e("div",et,[tt,u(e("input",{type:"text",name:"Name","onUpdate:modelValue":t[3]||(t[3]=s=>n.value.Name=s),class:"form-control"},null,512),[[h,n.value.Name]])]),e("div",st,[ot,u(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[4]||(t[4]=s=>n.value.Description=s),class:"form-control"},null,512),[[h,n.value.Description]])])])])]),e("div",at,[nt,e("div",null,[it,e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=s=>A())},"存檔")])])])])]),e("div",lt,[e("div",dt,[e("div",ct,[rt,e("div",mt,[e("form",pt,[e("div",ut,[e("div",ht,[_t,u(e("input",{type:"text",name:"TagGroup","onUpdate:modelValue":t[6]||(t[6]=s=>n.value.TagGroup=s),disabled:"",class:"form-control"},null,512),[[h,n.value.TagGroup]])]),e("div",gt,[vt,u(e("input",{type:"text",name:"Description","onUpdate:modelValue":t[7]||(t[7]=s=>g.value=s),class:"form-control"},null,512),[[h,g.value]])])])])]),e("div",bt,[ft,e("div",null,[xt,e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=s=>L(n.value.TagGroup))},"存檔")])])])])])]),_:1})]),_:1}))}},Ct=U(wt,[["__scopeId","data-v-18c9b86c"]]);export{Ct as default};
