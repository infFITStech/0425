import{p as Q,U as W,r as _,s as O,o as i,c as G,w as P,_ as ee,c2 as x,a as V,X as te,E as R,Y as se,f as b,b as e,j as n,z as g,n as r,t as m,F as p,Z as H,k as u,e as oe,a2 as L,R as le,S as ie}from"./index-d76512cf.js";import"./bootstrap.min-b3a7f698.js";const c=f=>(le("data-v-404d6f1a"),f=f(),ie(),f),ne={class:"container-fluid pb-3"},ae={class:"col-12"},de={class:"h-100 flex-grow-1 bg-white rounded container-fluid"},ce={class:"row d-flex align-items-center py-3"},re={class:"col-2 col-md-1 flex-grow-0 mb-4 mb-md-0"},me={class:"profile-img"},he={class:"img-circle-wrapper"},_e=["src"],ge={class:"col-8 col-md-2 text-body font-bold mb-4 mb-md-0"},pe={class:"d-block d-md-none col-2 text-right"},ue=["onClick"],ve=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})],-1)),we=[ve],xe={class:"col-12 px-md-0 col-md flex-shrink-0 flex-grow-1 d-flex flex-column flex-md-row align-items-stretch"},fe={class:"dropdown mr-md-2 mr-lg-3 mb-1 mb-md-0"},be={class:"w-100 btn btn-primary rounded-pill dropdown-toggle",type:"button","data-toggle":"dropdown","aria-expanded":"false"},ye={class:"dropdown-menu"},ke=c(()=>e("div",{class:"dropdown-item",disabled:""}," 選擇欲顯示的詢問動線 ",-1)),Te=["onClick"],Ce={class:"dropdown mr-md-2 mb-1 mb-md-0"},ze=c(()=>e("button",{class:"w-100 btn btn-primary rounded-pill dropdown-toggle",type:"button","data-toggle":"dropdown","aria-expanded":"false"},m("新增標籤"),-1)),Me=["id"],Be={class:"text-right"},Pe=["onClick"],Se=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),Ie=[Se],Ne={class:"text-gray ml-2 mb-2"},$e={class:"container-fluid"},Ve={class:"row"},Re=["onClick"],He={key:0,class:"position-absolute left-0",style:{top:"50%",transform:"translate(50%, -50%)"}},Le=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("g",{fill:"none"},[e("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),e("path",{fill:"currentColor",d:"M11 20a1 1 0 1 0 2 0v-7h7a1 1 0 1 0 0-2h-7V4a1 1 0 1 0-2 0v7H4a1 1 0 1 0 0 2h7z"})])],-1)),Je=[Le],Ee={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-2"},Fe={class:"profile-img mr-1",style:{border:"none",width:"20px","min-width":"20px"}},De={class:"img-circle-wrapper"},je=["src"],Ae={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},Ue=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),Xe=[Ue],Ye={class:"container-fluid px-2 mr-md-2"},Ze={class:"row"},qe=["onClick"];const Ke={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-2"},Qe={class:"profile-img mr-1 ml-0",style:{border:"none",width:"20px","min-width":"20px"}},We={class:"img-circle-wrapper"},Oe=["src"],Ge={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},et=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),tt=[et],st=["id"],ot=["onClick"];const lt={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-2"},it={class:"profile-img mr-1 ml-0",style:{border:"none",width:"20px","min-width":"20px"}},nt={class:"img-circle-wrapper"},at=["src"],dt={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},ct=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),rt=[ct],mt={key:0,class:"flex-shrink-0"},ht=["data-target","aria-controls"],_t=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M14 10.25a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.249 1.249 0 1 1 2.5 0a1.25 1.25 0 1 1-2.5 0"})],-1)),gt=[_t],pt=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M14 10.25a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.249 1.249 0 1 1 2.5 0a1.25 1.25 0 1 1-2.5 0"})],-1)),ut=[pt],vt={class:"d-none d-md-block col-auto text-right"},wt=["onClick"],xt=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})],-1)),ft=[xt],bt={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},yt={class:"modal-dialog modal-dialog-centered",role:"document"},kt={class:"modal-content"},Tt=c(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),Ct=c(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此產品？")],-1)),zt={class:"modal-footer border-0"},Mt=c(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),Bt={key:0,style:{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px","z-index":"2147483647",background:"rgba(0, 0, 0, 0.5)",transform:"none"}},Pt={id:"inffits_cblock",style:{"z-index":"60",display:"block",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto"}},St={id:"tryon"},It=["src"],Nt={__name:"ProductView",setup(f){const J=W().resolve({name:"IframeContainer"}).href,y=_(!1),E=_([]),k=_([]),S=_([]),I=_([]),N=_({Route:"",Tags:{}}),F=async()=>{const t=await x.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand=INFS&Per_Page=100&Page=1"),l={};t.data.models.forEach(s=>{l[s.TagGroup]||(l[s.TagGroup]=[]),l[s.TagGroup].push(s)}),k.value=[],k.value=Object.keys(l).map(s=>({group:s,tags:l[s]}))},D=async()=>{const t=await x.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_routes?Brand=INFS&Per_Page=100&Page=1");S.value=[...t.data.models]},T=async()=>{const t=await x.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_products?Brand=INFS&Per_Page=100&Page=1");E.value=t.data.models,I.value=[...t.data.models]},C=(t={id:String(new Date().getTime()),Tags:{},Routes:[]},l=!0,s="editModal")=>{N.value=Object.assign({id:String(new Date().getTime()),Tags:{},Routes:[]},JSON.parse(JSON.stringify(t))),l&&j(s)},j=t=>{L(`#${t}`).modal("toggle")},A=t=>(t==null?void 0:t[0].Name)||null,z=(t,l,s)=>t.Tags[l]&&t.Tags[l].some(a=>a.Tag===s.Tag),$=(t,l,s)=>{const a=t.Tags[l].findIndex(o=>o.Tag===s.Tag);a!==-1&&(t.Tags[l].splice(a,1),B({Routes:t.Routes,Tags:t.Tags,id:t.id}))},U=t=>{L(t).dropdown("hide")},X=(t,l)=>{t.Routes=[l],B({Routes:t.Routes,Tags:t.Tags,id:t.id})},Y=(t,l,s)=>{t.Tags[l]||(t.Tags[l]=[]);const a=t.Tags[l].findIndex(o=>o.Tag===s.Tag);a===-1?t.Tags[l].push(s):t.Tags[l].splice(a,1),B({Product:t.Product,Tags:t.Tags,id:t.id})},M=t=>{const l=[];for(const s in t.Tags)t.Tags[s].forEach(a=>{l.push({tag:a,group:s})});return JSON.parse(JSON.stringify(l))},B=async t=>{const l={Brand:"INFS",...t},s=await x.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_product",l);console.log(s),T()},Z=()=>{y.value=!y.value},q=async()=>{const t=await x.delete(`https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_product?Brand=INFS&id=${N.value.id}`);console.log(t),T(),C({},!0,"deleteModal")};return O(()=>{F(),D(),T()}),(t,l)=>(i(),G(ee,null,{default:P(()=>[V(oe,null,{default:P(()=>[V(te,{icon:R(se),title:"產品管理",main:""},{default:P(()=>[b("   ")]),_:1},8,["icon"]),e("div",ne,[(i(!0),n(p,null,g(I.value,(s,a)=>(i(),n("div",{key:a,class:"row mb-3"},[e("div",ae,[e("div",de,[e("div",ce,[e("div",re,[e("div",me,[e("div",he,[e("div",{class:r(["img-circle img-fluid bg-gray-light",s.Imgsrc?"":"d-none"])},null,2),e("img",{class:r(["img-circle img-fluid",s.Imgsrc?"":"d-none"]),src:s.Imgsrc,alt:""},null,10,_e)])])]),e("div",ge,m(s.ItemName),1),e("div",pe,[e("div",{class:"h3 text-danger d-inline-flex align-items-center cursor-pointer mr-4",onClick:o=>C(s,!0,"deleteModal")},we,8,ue)]),e("div",xe,[e("div",fe,[e("button",be,m(A(s.Routes)||"選擇動線"),1),e("div",ye,[ke,(i(!0),n(p,null,g(S.value,(o,d)=>(i(),n("div",{key:o.Route,class:"dropdown-item",onClick:h=>X(s,o)},m(o.Name)+" ("+m(o.TagGroups_order.join(" - "))+") ",9,Te))),128))])]),e("div",Ce,[ze,e("div",{id:`tagDropdownMenu${a}`,class:"dropdown-menu p-2",style:{"min-width":"400px"},onclick:"event.stopPropagation()"},[e("div",Be,[e("button",{type:"button",class:"btn btn-sm rounded-circle",onClick:H(o=>U(`#tagDropdownMenu${a}`),["stop"])},Ie,8,Pe)]),(i(!0),n(p,null,g(k.value,o=>(i(),n("div",{key:o,class:"d-flex flex-column mb-2"},[e("div",Ne,m(o.group||"新增標籤"),1),e("div",$e,[e("div",Ve,[(i(!0),n(p,null,g(o.tags,d=>(i(),n("div",{key:d,class:"col-4 p-0 px-1 mb-2"},[e("div",{class:r(["w-100 rounded-pill cursor-pointer d-flex align-items-center border position-relative",z(s,o.group,d)?"bg-secondary text-white":"bg-white text-secondary"]),onClick:H(h=>Y(s,o.group,d),["stop"]),style:{"line-height":"1"}},[z(s,o.group,d)?u("",!0):(i(),n("div",He,Je)),e("div",Ee,[e("div",Fe,[e("div",De,[e("div",{class:r(["img-circle img-fluid",d.Imgsrc?"":"d-none"])},null,2),e("img",{class:r(["img-circle img-fluid",d.Imgsrc?"":"d-none"]),src:d.Imgsrc,alt:""},null,10,je)])]),b(" "+m(d.Name),1)]),z(s,o.group,d)?(i(),n("div",Ae,Xe)):u("",!0)],10,Re)]))),128))])])]))),128))],8,Me)]),e("div",Ye,[e("div",Ze,[(i(!0),n(p,null,g(JSON.parse(JSON.stringify(M(s))).slice(0,4),o=>{var d,h,v,w;return i(),n("div",{key:o,class:"col-12 col-md-3 p-0 px-1 mb-1 mb-md-0"},[e("div",{class:r(["w-100 rounded-pill cursor-pointer d-flex align-items-center border position-relative","bg-secondary text-white"]),onClick:K=>$(s,o.tag.TagGroup,o.tag)},[u("",!0),e("div",Ke,[e("div",Qe,[e("div",We,[e("div",{class:r(["img-circle img-fluid bg-white border-primary",(d=o.tag)!=null&&d.Imgsrc?"d-none":""])},null,2),e("img",{class:r(["img-circle img-fluid",(h=o.tag)!=null&&h.Imgsrc?"":"d-none"]),src:(v=o.tag)==null?void 0:v.Imgsrc,alt:""},null,10,Oe)])]),b(" "+m((w=o.tag)==null?void 0:w.Name),1)]),(i(),n("div",Ge,tt))],8,qe)])}),128))]),e("div",{class:"collapse row",id:`collapseTag${a}`},[(i(!0),n(p,null,g(JSON.parse(JSON.stringify(M(s))).slice(4),o=>{var d,h,v,w;return i(),n("div",{key:o,class:"col-12 col-md-3 p-0 px-1 mb-1 mb-md-0"},[e("div",{class:r(["w-100 rounded-pill cursor-pointer d-flex align-items-center border position-relative","bg-secondary text-white"]),onClick:K=>$(s,o.tag.TagGroup,o.tag)},[u("",!0),e("div",lt,[e("div",it,[e("div",nt,[e("div",{class:r(["img-circle img-fluid bg-white border-primary",(d=o.tag)!=null&&d.Imgsrc?"d-none":""])},null,2),e("img",{class:r(["img-circle img-fluid",(h=o.tag)!=null&&h.Imgsrc?"":"d-none"]),src:(v=o.tag)==null?void 0:v.Imgsrc,alt:""},null,10,at)])]),b(" "+m((w=o.tag)==null?void 0:w.Name),1)]),(i(),n("div",dt,rt))],8,ot)])}),128))],8,st)]),M(s).length>4?(i(),n("div",mt,[e("button",{class:"btn h4 mb-0 p-0 bg-white border d-flex align-items-center justify-content-center rounded-pill rounded-md-circle",type:"button","data-toggle":"collapse","data-target":`#collapseTag${a}`,"aria-expanded":"false","aria-controls":`collapseTag${a}`,style:{width:"2rem",height:"2rem"}},gt,8,ht),e("button",{class:"btn h4 mb-0 p-0 bg-white border d-flex align-items-center justify-content-center rounded-pill rounded-md-circle",type:"button",onClick:l[0]||(l[0]=o=>Z()),style:{width:"2rem",height:"2rem"}},ut)])):u("",!0)]),e("div",vt,[e("div",{class:"h3 text-danger d-inline-flex align-items-center cursor-pointer",onClick:o=>C(s,!0,"deleteModal")},ft,8,wt)])])])])]))),128)),e("div",bt,[e("div",yt,[e("div",kt,[Tt,Ct,e("div",zt,[Mt,e("button",{type:"button",class:"btn btn-primary",onClick:l[1]||(l[1]=s=>q())},"刪除")])])])])]),y.value?(i(),n("div",Bt,[e("div",Pt,[e("div",St,[e("iframe",{id:"inffits_tryon_window",style:{width:"100%",height:"100%",visibility:"visible",position:"relative",border:"none",outline:"none","z-index":"14","border-radius":"10px","box-shadow":"rgba(0, 0, 0, 0.15) 0px 2px 8px"},src:R(J)},null,8,It)])])])):u("",!0)]),_:1})]),_:1}))}},Ht=Q(Nt,[["__scopeId","data-v-404d6f1a"]]);export{Ht as default};
