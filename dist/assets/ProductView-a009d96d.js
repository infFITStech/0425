import{m as ee,U as te,r as g,q as se,o as l,c as oe,w as S,_ as ie,c2 as x,a as H,X as le,D,Y as ne,e as y,b as e,i as n,y as p,n as c,t as h,F as u,Z as J,j as f,S as ae,a2 as k,Q as de,R as re}from"./index-e77d52a8.js";import{_ as E}from"./inffits_f_black-f5176971.js";import"./bootstrap.min-6e4ebdd2.js";const r=b=>(de("data-v-d839d9e7"),b=b(),re(),b),ce={class:"container-fluid pb-3"},me={class:"col-12"},he={class:"h-100 flex-grow-1 bg-white rounded container-fluid"},ge={class:"row d-flex align-items-center py-4"},_e={class:"col-2 col-md-1 flex-grow-0 mb-4 mb-md-0 px-3",style:{"max-width":"max-content"}},pe={class:"profile-img m-0"},ue={class:"img-circle-wrapper"},we=["src"],ve={class:"col-8 col-md-2 text-body font-bold mb-4 mb-md-0 px-0",style:{"white-space":"nowrap","overflow-x":"scroll","-ms-overflow-style":"none","scrollbar-width":"none"}},xe={class:"d-block d-md-none col-1 text-right mr-3"},fe={class:"flex-shrink-0 mr-1",style:{display:"inline-flex"}},be=["onClick"],ye=r(()=>e("img",{src:E,alt:"f",class:"m-1",style:{height:"10px",width:"auto","vertical-align":"middle","margin-right":"3px"}},null,-1)),ke={class:"d-block d-md-none col-1 text-right"},Te=["onClick"],Ce=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})],-1)),ze=[Ce],Me={class:"col-12 px-md-0 col-md flex-shrink-0 flex-grow-1 d-flex flex-column flex-md-row align-items-center"},Be={class:"dropdown mr-md-1 mr-lg-1 mb-1 mb-md-0 ml-1"},Ie={class:"w-100 btn border dropdown-toggle rounded-pill",type:"button","data-toggle":"dropdown","aria-expanded":"false",style:{color:"gray"}},Pe={class:"dropdown-menu"},Se=r(()=>e("div",{class:"dropdown-item",disabled:""}," 選擇欲顯示的詢問動線 ",-1)),Ne=["onClick"],$e={class:"dropdown mr-md-1 mb-1 mb-md-0"},Ve=r(()=>e("button",{class:"w-100 btn border dropdown-toggle",type:"button","data-toggle":"dropdown","aria-expanded":"false",style:{color:"gray"}},h("新增標籤"),-1)),Re=["id"],Le={class:"text-right"},He=["onClick"],De=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),Je=[De],Ee={class:"text-gray ml-2 mb-2"},Fe={class:"container-fluid"},je={class:"row"},We=["onClick"],qe={key:0,class:"position-absolute left-0",style:{top:"50%",transform:"translate(50%, -50%)"}},Ae=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[e("g",{fill:"none"},[e("path",{d:"M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),e("path",{fill:"currentColor",d:"M11 20a1 1 0 1 0 2 0v-7h7a1 1 0 1 0 0-2h-7V4a1 1 0 1 0-2 0v7H4a1 1 0 1 0 0 2h7z"})])],-1)),Qe=[Ae],Ue={class:"w-100 text-center d-inline-flex align-items-center px-3 px-md-4 py-1 py-md-1"},Xe={class:"profile-img mr-1",style:{border:"none",width:"20px","min-width":"20px"}},Ye={class:"img-circle-wrapper"},Ze=["src"],Ke={key:1,class:"position-absolute right-0",style:{top:"50%",transform:"translate(-50%, -50%)"}},Oe=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),Ge=[Oe],et={class:"container-fluid px-0 mr-md-2 border py-1 px-2",style:{"border-radius":"13px"}},tt={class:"row m-0"};const st={class:"w-100 text-center d-inline-flex align-items-center px-3 pr-md-4 py-1 border",style:{"border-radius":"6px","box-shadow":"rgba(0,0,0,0.15) 0 2px 8px"}},ot={class:"profile-img mr-1 ml-0",style:{border:"none",width:"20px","min-width":"20px"}},it={class:"img-circle-wrapper"},lt=["src"],nt={style:{"white-space":"nowrap","overflow-x":"scroll","-ms-overflow-style":"none","scrollbar-width":"none"}},at=["onClick"],dt=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),rt=[dt],ct={key:0,class:"flex-shrink-0 inline-block"},mt=["data-target","aria-controls"],ht=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M14 10.25a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0m-5 0a1.249 1.249 0 1 1 2.5 0a1.25 1.25 0 1 1-2.5 0"})],-1)),gt=[ht],_t=["id"];const pt={class:"w-100 text-center d-inline-flex align-items-center px-3 pr-md-4 py-1 border",style:{"border-radius":"6px","box-shadow":"rgba(0,0,0,0.15) 0 2px 8px"}},ut={class:"profile-img mr-1 ml-0",style:{border:"none",width:"20px","min-width":"20px"}},wt={class:"img-circle-wrapper"},vt=["src"],xt={style:{"white-space":"nowrap","overflow-x":"scroll","-ms-overflow-style":"none","scrollbar-width":"none"}},ft=["onClick"],bt=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 18 18"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m15.5 15.5l-10-10zm0-10l-10 10"})],-1)),yt=[bt],kt={class:"d-none d-md-flex col-auto text-right pr-2 pl-0 align-items-center"},Tt={class:"flex-shrink-0 mr-1",style:{display:"inline-flex"}},Ct=["onClick"],zt=r(()=>e("img",{src:E,alt:"f",class:"m-1",style:{height:"10px",width:"auto","vertical-align":"middle","margin-right":"3px"}},null,-1)),Mt=["onClick"],Bt=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"0.9em",height:"0.9em",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})],-1)),It=[Bt],Pt={class:"modal fade",id:"deleteModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},St={class:"modal-dialog modal-dialog-centered",role:"document"},Nt={class:"modal-content"},$t=r(()=>e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title"},"確認刪除"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),Vt=r(()=>e("div",{class:"modal-body"},[e("h5",null,"是否確認刪除此產品？")],-1)),Rt={class:"modal-footer border-0"},Lt=r(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"取消操作",-1)),Ht={id:"preview_box",style:{position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px","z-index":"2147483647",background:"rgba(0, 0, 0, 0.5)",transform:"none",display:"none"}},Dt={id:"inffits_cblock",style:{"z-index":"60",display:"block",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto"}},Jt={id:"tryon"},Et=["src"],Ft=r(()=>e("img",{src:"https://inffits.com/webDesign/HTML/img/cancel.png",style:{position:"absolute",top:"0",bottom:"0",right:"0",left:"0",width:"10px",margin:"auto"}},null,-1)),jt=[Ft],Wt={__name:"ProductView",setup(b){const F=te().resolve({name:"IframeContainer"}).href,m=g(4),j=g(!1),W=g([]),T=g([]),N=g([]),$=g([]),V=g({Route:"",Tags:{}});window.addEventListener("resize",()=>{window.innerWidth<990?m.value=2:window.innerWidth<1150?m.value=3:m.value=4});const q=async()=>{const t=await x.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_tags?Brand=INFS&Per_Page=100&Page=1"),i={};t.data.models.forEach(s=>{i[s.TagGroup]||(i[s.TagGroup]=[]),i[s.TagGroup].push(s)}),T.value=[],T.value=Object.keys(i).map(s=>({group:s,tags:i[s]}))},A=async()=>{const t=await x.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_routes?Brand=INFS&Per_Page=100&Page=1");N.value=[...t.data.models]},C=async()=>{const t=await x.get("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/get_products?Brand=INFS&Per_Page=100&Page=1");W.value=t.data.models,$.value=[...t.data.models]},z=(t={id:String(new Date().getTime()),Tags:{},Routes:[]},i=!0,s="editModal")=>{V.value=Object.assign({id:String(new Date().getTime()),Tags:{},Routes:[]},JSON.parse(JSON.stringify(t))),i&&Q(s)},Q=t=>{k(`#${t}`).modal("toggle")},U=t=>(t==null?void 0:t[0].Name)||null,M=(t,i,s)=>t.Tags[i]&&t.Tags[i].some(a=>a.Tag===s.Tag),R=(t,i,s)=>{const a=t.Tags[i].findIndex(o=>o.Tag===s.Tag);a!==-1&&(t.Tags[i].splice(a,1),P({Routes:t.Routes,Tags:t.Tags,id:t.id}))},X=t=>{k(t).dropdown("hide")},Y=(t,i)=>{t.Routes=[i],P({Routes:t.Routes,Tags:t.Tags,id:t.id})},Z=()=>{k("#preview_box").fadeOut(),setTimeout(()=>{j.value=!1},400)},K=(t,i,s)=>{t.Tags[i]||(t.Tags[i]=[]);const a=t.Tags[i].findIndex(o=>o.Tag===s.Tag);a===-1?t.Tags[i].push(s):t.Tags[i].splice(a,1),P({Product:t.Product,Tags:t.Tags,id:t.id})},B=t=>{const i=[];for(const s in t.Tags)t.Tags[s].forEach(a=>{i.push({tag:a,group:s})});return JSON.parse(JSON.stringify(i))},I=g(null),P=async t=>{const i={Brand:"INFS",...t},s=await x.post("https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/update_product",i);console.log(s),C()},L=(t,i)=>{k("#preview_box").fadeIn();var s={};s.id=t,s.header="from_preview",s.brand=i,I.value&&I.value.contentWindow.postMessage(s,"*")},O=async()=>{const t=await x.delete(`https://xjsoc4o2ci.execute-api.ap-northeast-1.amazonaws.com/v0/extension/del_product?Brand=INFS&id=${V.value.id}`);console.log(t),C(),z({},!0,"deleteModal")};return se(()=>{q(),A(),C(),window.innerWidth<990?m.value=2:window.innerWidth<1150?m.value=3:m.value=4}),(t,i)=>(l(),oe(ie,null,{default:S(()=>[H(ae,null,{default:S(()=>[H(le,{icon:D(ne),title:"產品管理",main:""},{default:S(()=>[y("   ")]),_:1},8,["icon"]),e("div",ce,[(l(!0),n(u,null,p($.value,(s,a)=>(l(),n("div",{key:a,class:"row mb-3"},[e("div",me,[e("div",he,[e("div",ge,[e("div",_e,[e("div",pe,[e("div",ue,[e("div",{class:c(["img-circle img-fluid bg-gray-light",s.Imgsrc?"":"d-none"])},null,2),e("img",{class:c(["img-circle img-fluid",s.Imgsrc?"":"d-none"]),src:s.Imgsrc,alt:""},null,10,we)])])]),e("div",ve,h(s.ItemName),1),e("div",xe,[e("div",fe,[e("button",{class:"btn h4 mb-0 pl-2 bg-white border d-flex align-items-center justify-content-center rounded-pill rounded-md-circle",type:"button",onClick:o=>L(s.ClothID),style:{"box-shadow":"rgba(0,0,0,0.15) 0 2px 8px","font-size":"12px"}},[ye,y(" 預覽 ")],8,be)])]),e("div",ke,[e("div",{class:"h3 text-danger d-inline-flex align-items-center cursor-pointer mr-4",onClick:o=>z(s,!0,"deleteModal")},ze,8,Te)]),e("div",Me,[e("div",Be,[e("button",Ie,h(U(s.Routes)||"動線規劃"),1),e("div",Pe,[Se,(l(!0),n(u,null,p(N.value,(o,d)=>(l(),n("div",{key:o.Route,class:"dropdown-item",onClick:_=>Y(s,o)},h(o.Name)+" ("+h(o.TagGroups_order.join(" - "))+") ",9,Ne))),128))])]),e("div",$e,[Ve,e("div",{id:`tagDropdownMenu${a}`,class:"dropdown-menu p-2",style:{"min-width":"400px"},onclick:"event.stopPropagation()"},[e("div",Le,[e("button",{type:"button",class:"btn btn-sm rounded-circle",onClick:J(o=>X(`#tagDropdownMenu${a}`),["stop"])},Je,8,He)]),(l(!0),n(u,null,p(T.value,o=>(l(),n("div",{key:o,class:"d-flex flex-column mb-2"},[e("div",Ee,h(o.group||"新增標籤"),1),e("div",Fe,[e("div",je,[(l(!0),n(u,null,p(o.tags,d=>(l(),n("div",{key:d,class:"col-4 p-0 px-1 mb-2"},[e("div",{class:c(["w-100 cursor-pointer d-flex align-items-center border position-relative",M(s,o.group,d)?"bg-secondary text-white":"bg-white text-secondary"]),onClick:J(_=>K(s,o.group,d),["stop"]),style:{"line-height":"1","border-radius":"6px","box-shadow":"rgba(0,0,0,0.15) 0 2px 8px"}},[M(s,o.group,d)?f("",!0):(l(),n("div",qe,Qe)),e("div",Ue,[e("div",Xe,[e("div",Ye,[e("div",{class:c(["img-circle img-fluid",d.Imgsrc?"":"d-none"])},null,2),e("img",{class:c(["img-circle img-fluid",d.Imgsrc?"":"d-none"]),src:d.Imgsrc,alt:""},null,10,Ze)])]),y(" "+h(d.Name),1)]),M(s,o.group,d)?(l(),n("div",Ke,Ge)):f("",!0)],10,We)]))),128))])])]))),128))],8,Re)]),e("div",et,[e("div",tt,[(l(!0),n(u,null,p(JSON.parse(JSON.stringify(B(s))).slice(0,m.value),o=>{var d,_,w,v;return l(),n("div",{key:o,class:"col-12 col-md-3 p-0 px-1 mb-1 mb-md-0"},[e("div",{class:c(["w-100 d-flex align-items-center position-relative","bg-white text-gray"]),style:{cursor:"default"}},[f("",!0),e("div",st,[e("div",ot,[e("div",it,[e("div",{class:c(["img-circle img-fluid bg-white border-primary",(d=o.tag)!=null&&d.Imgsrc?"d-none":""])},null,2),e("img",{class:c(["img-circle img-fluid",(_=o.tag)!=null&&_.Imgsrc?"":"d-none"]),src:(w=o.tag)==null?void 0:w.Imgsrc,alt:""},null,10,lt)])]),e("div",nt,h((v=o.tag)==null?void 0:v.Name),1)]),(l(),n("div",{key:1,class:"position-absolute right-0 cursor-pointer",style:{top:"50%",transform:"translate(-50%, -50%)"},onClick:G=>R(s,o.tag.TagGroup,o.tag)},rt,8,at))])])}),128)),B(s).length>m.value?(l(),n("div",ct,[e("button",{class:"btn h4 mb-0 p-0 bg-white border d-flex align-items-center justify-content-center rounded-pill rounded-md-circle",type:"button","data-toggle":"collapse","data-target":`#collapseTag${a}`,"aria-expanded":"false","aria-controls":`collapseTag${a}`,style:{width:"2rem",height:"2rem"}},gt,8,mt)])):f("",!0)]),e("div",{class:"collapse row m-0 mt-1",id:`collapseTag${a}`},[(l(!0),n(u,null,p(JSON.parse(JSON.stringify(B(s))).slice(m.value),o=>{var d,_,w,v;return l(),n("div",{key:o,class:"col-12 col-md-3 p-0 px-1 mb-1 mb-md-1"},[e("div",{class:c(["w-100 d-flex align-items-center position-relative","bg-white text-gray"]),style:{cursor:"default"}},[f("",!0),e("div",pt,[e("div",ut,[e("div",wt,[e("div",{class:c(["img-circle img-fluid bg-white border-primary",(d=o.tag)!=null&&d.Imgsrc?"d-none":""])},null,2),e("img",{class:c(["img-circle img-fluid",(_=o.tag)!=null&&_.Imgsrc?"":"d-none"]),src:(w=o.tag)==null?void 0:w.Imgsrc,alt:""},null,10,vt)])]),e("div",xt,h((v=o.tag)==null?void 0:v.Name),1)]),(l(),n("div",{key:1,class:"position-absolute right-0 cursor-pointer",style:{top:"50%",transform:"translate(-50%, -50%)"},onClick:G=>R(s,o.tag.TagGroup,o.tag)},yt,8,ft))])])}),128))],8,_t)])]),e("div",kt,[e("div",Tt,[e("button",{class:"btn h4 mb-0 pl-2 bg-white border d-flex align-items-center justify-content-center rounded-pill rounded-md-circle",type:"button",onClick:o=>L(s.ClothID,s.Brand),style:{"box-shadow":"rgba(0,0,0,0.15) 0 2px 8px","font-size":"12px"}},[zt,y(" 預覽 ")],8,Ct)]),e("div",{class:"h3 text-danger d-inline-flex align-items-center cursor-pointer mb-0",onClick:o=>z(s,!0,"deleteModal")},It,8,Mt)])])])])]))),128)),e("div",Pt,[e("div",St,[e("div",Nt,[$t,Vt,e("div",Rt,[Lt,e("button",{type:"button",class:"btn btn-primary",onClick:i[0]||(i[0]=s=>O())},"刪除")])])])])]),e("div",Ht,[e("div",Dt,[e("div",Jt,[e("iframe",{ref_key:"myiframe",ref:I,id:"inffits_tryon_window",style:{width:"100%",height:"100%",visibility:"visible",position:"relative",border:"none",outline:"none","z-index":"14","border-radius":"10px","box-shadow":"rgba(0, 0, 0, 0.15) 0px 2px 8px"},src:D(F)},null,8,Et)]),e("div",{id:"inf_close",onClick:i[1]||(i[1]=s=>Z()),style:{cursor:"pointer",position:"absolute",top:"-5px","z-index":"10000009",right:"-10px",padding:"5px",height:"25px",width:"25px","border-radius":"50%","box-shadow":"rgb(54 62 81 / 15%) 0px 0.0625rem 0.125rem 0.0625rem",background:"white",opacity:"1"}},jt)])])]),_:1})]),_:1}))}},Xt=ee(Wt,[["__scopeId","data-v-d839d9e7"]]);export{Xt as default};
